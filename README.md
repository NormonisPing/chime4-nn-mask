# CHiME4 NN-based mask estimation

Implementation of BLSTM mask estimator in pytorch.

### Usage
follow `run.sh`:
1. split `.json` file under `CHiME4/data/annotations`, so we can generate data parallelly.
2. seperate clean/noise part of data from simulate data in CHiME4.
3. generate masks and clean/noise spectrums for NN training.
4. train a simple mask estimator
5. enhance multi-channel data by GEV beamformer, using masks generated by estimator.

NOTE: I reuse `beamforming.py`, `mask_estimation.py`, `utils.py`, `signal_processing.py` in [nn-gev](https://github.com/fgnt/nn-gev)

### Experiment

* 6ch(official DNN baseline, ch5)

| Methods | Dev Simu | Dev Real | Eval Simu | Eval Real |
|  :---:  |  :---:   |   :---:  |   :---:   |   :---:   |
|Beamformit(SAT)| 14.36%  | 12.99%   | 21.24%    | 21.55%    |
|  CGMM(SAT)    | 12.65%  | 11.39%   | 20.18%    | 19.72%    |
|  BLSTM + GEV(SAT)    | 11.24%  | 10.77%   | 13.16%    | 15.59%    |
|Beamformit(DNN)| 10.29%  | 9.59%   | 15.79%    | 16.73%    |
| CGMM(DNN) | 8.76%  | 8.60%   | 15.23%    | 15.18%    |
|  BLSTM + GEV(DNN)    | 7.93%  | 8.00%   | 10.05%    | 11.94%    |
 Beamformit(DNN + sMBR) | 9.11%  | 8.46%   | 14.54%    | 15.07%    |
|  CGMM(DNN + sMBR)    | 7.96%  | 7.61%   | 14.47%    | 14.05%    |
|  BLSTM + GEV(DNN + sMBR)    | 7.17%  | 7.14%   | 9.18%    | 10.63%    |
|  BLSTM + GEV(5-gram)    | 6.00%  | 7.46%   | 7.61%    | 9.20%    |
|  BLSTM + GEV(RNNLM)    | 5.21%  | 5.03%   | 6.48%    | 7.64%    |

Adam brings less loss when training of BLSTM mask estimator finished, but do not bring lower WER for recognition tasks. 
Results of experiment are followings:

| Methods | Dev Simu | Dev Real | Eval Simu | Eval Real |
|  :---:  |  :---:   |   :---:  |   :---:   |   :---:   |
|  BLSTM_ADAM + GEV(SAT)    | 11.36%  | 11.00%   | 13.35%    | 15.67%    |
|  BLSTM_ADAM + GEV(DNN)    | 8.15%  | 7.86%   | 10.24%    | 11.66%    |
|  BLSTM_ADAM + GEV(DNN + sMBR)    | 7.33%  | 6.90%   | 9.60%    | 10.92%    |


* 6ch(official DNN baseline, ch1,3-6)

| Methods | Dev Simu | Dev Real | Eval Simu | Eval Real |
|  :---:  |  :---:   |   :---:  |   :---:   |   :---:   |
|  BLSTM + GEV(DNN)    | 7.39%  | 7.46%   | 8.88%    | 10.47%    |
|  BLSTM + GEV(DNN + sMBR)    | 6.62%  | 6.36%   | 8.40%    | 9.35%    |
|  BLSTM + GEV(5-gram)    | 5.35%  | 5.16%   | 7.08%    | 8.14%    |
|  BLSTM + GEV(RNNLM)    | 4.56%  | 4.38%   | 6.08%    | 6.93%    |

### Reference
* Heymann J, Drude L, Haebumbach R. Neural network based spectral mask estimation for acoustic beamforming.[J]. IEEE Transactions on Industrial Electronics, 2016, 46(3):544-553.
* https://github.com/fgnt/nn-gev